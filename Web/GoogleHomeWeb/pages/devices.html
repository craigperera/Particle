<!DOCTYPE html>
<html>

<head>
    <title>Particle Device List</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="Register Login Widget template Responsive, Login form web template,Flat Pricing tables,Flat Drop downs  Sign up Web Templates, Flat Web Templates, Login Signup Responsive web template, SmartPhone Compatible web template, free WebDesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design"
    />

    <link href='//fonts.googleapis.com/css?family=Jura:400,300,500,600' rel='stylesheet' type='text/css'>
    <link href="styles/main.css" rel="stylesheet" type="text/css" media="all" />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    <script>
        $(document).ready(function () {

            var loader = document.getElementById("overlay");
            loader.style.display = "block";

            var loaderText = $("#loading-text");
            loaderText.css('margin-left', '-50px');
            loaderText.text("Loading Devices ...");

            $.post("/deviceList", function (data) {

                loader.style.display = "none";

                if (data.isError) {

                    alert(data.redirect);
                    return;
                }

                var table = document.getElementById("devTable");

                for (var i = 0; i < data.deviceList.length; i++) {

                    var row = table.insertRow(i + 1);
                    var device = data.deviceList[i];

                    var cell1 = row.insertCell(0);
                    var cell2 = row.insertCell(1);
                    var rowSpan = device.response.traits.length;

                    cell1.innerHTML = device.deviceId;
                    cell1.rowSpan = rowSpan;
                    cell2.innerHTML = device.response.type;
                    cell2.rowSpan = rowSpan;

                    for (var ia = 0; ia < rowSpan; ia++) {

                        var trait = device.response.traits[ia];

                        if (ia > 0) {

                            var r2 = table.insertRow(i + ia + 1);
                            var cell3 = r2.insertCell(0);
                            cell3.innerHTML = trait;
                        }
                        else {

                            var cell3 = row.insertCell(2);
                            cell3.innerHTML = trait;
                        }
                    }
                }
            });
        });
    </script>
</head>

<body>
    <div id="overlay">
        <img id="loading" src="images/ajax-loader.gif" />
        <h2 id="loading-text">Loading ...</h2>
    </div>

    <div>
        <h1>Google Enabled Devices</h1>
        <br/>
        <table id="devTable">
            <th>
                Device Id
            </th>
            <th>
                Device Type
            </th>
            <th>
                Device Traits
            </th>
        </table>
    </div>
</body>

</html>